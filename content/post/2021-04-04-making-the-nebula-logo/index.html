---
title: Making the nebula logo
author: Conor Neilson
date: '2021-04-04'
slug: making-the-nebula-logo
categories:
  - R
tags:
  - R
  - nebula
featureImage: images/nelson_lakes_photo.jpg
---

<script src="{{< blogdown/postref >}}index_files/header-attrs/header-attrs.js"></script>


<p>Recently I made a logo for my in-development <code>nebula</code> package. This is how it’s done.</p>
<!--more-->
<p>Before I get into this post, I need to point out that all the work in this stands on the shoulders of the incredible developer, <a href="https://www.data-imaginist.com/">Thomas Lin Pedersen</a>. The work here heavily relies on his <a href="https://github.com/thomasp85/ambient">ambient</a> and <a href="https://github.com/thomasp85/ggfx">ggfx</a> packages, so most credit is due to him.</p>
<p>My <a href="https://github.com/condwanaland/nebula"><code>nebula</code></a> package is designed to help interactively age fish through counting the growth rings present in their ‘otoliths’ (ear bones). As an example, see the image below of an otolith I collected from a New Zealand <a href="https://en.wikipedia.org/wiki/Common_galaxias"><em>Galaxias maculatus</em></a>.</p>
<p><img src="images/whitebait-otolith-dark-small.png" width="400" height="300" /></p>
<p>This otolith is approx 0.5mm across, and each ring one day of growth in the fish (so this fish is approx 120 days old).</p>
<p>The reason <code>nebula</code> is named so, is that the rings of an otolith remind me of the rings sometimes seen in nebulas.</p>
<div class="figure">
<img src="images/nebula.png" width="400" height="300" alt="" />
<p class="caption">Image from NASA Jet Propulsion Laboratory</p>
</div>
<p>With these thoughts in mind, I wanted a logo representing the void-y, almost cloud like nature of nebulas, along with the rings from an otolith. To do this, I started with <code>ambient</code>.</p>
<p>Following Thomas’ examples, I started by generating a grid of values, and then adding some perlin noise to it (note that I am not showing the seed I used to generate this, so my logo will always be slightly unique).</p>
<pre class="r"><code>library(ggforce)
library(ggfx)
library(ambient)
library(dplyr)
library(viridisLite)

grid &lt;- long_grid(x = seq(0, 1, length.out = 100),
                  y = seq(0, 1, length.out = 100))

grid &lt;- grid %&gt;% 
  mutate(
    noise = fracture(gen_perlin, fbm, octaves = 4, x = x, y = y, freq_init = 5)
  )

grid</code></pre>
<pre><code>## # A tibble: 10,000 x 3
##        x      y noise
##    &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
##  1     0 0      0    
##  2     0 0.0101 0.117
##  3     0 0.0202 0.275
##  4     0 0.0303 0.423
##  5     0 0.0404 0.516
##  6     0 0.0505 0.553
##  7     0 0.0606 0.588
##  8     0 0.0707 0.605
##  9     0 0.0808 0.567
## 10     0 0.0909 0.520
## # … with 9,990 more rows</code></pre>
<p>This doesn’t look like much, but now we can plot something.</p>
<pre class="r"><code>ggplot() +
  geom_raster(aes(
    x = x,
    y = y,
    fill = noise),
  data = grid)</code></pre>
<p><img src="staticunnamed-chunk-2-1.png" width="672" /></p>
<p>Lets make this a bit more bold by giving it a different color scheme.</p>
<pre class="r"><code>ggplot() +
  geom_raster(aes(
    x = x,
    y = y,
    fill = noise),
  data = grid) + 
  scale_fill_viridis_c(option = &quot;inferno&quot;)</code></pre>
<p><img src="staticunnamed-chunk-3-1.png" width="672" /></p>
<p>Lets continue by adding some circles to this to represent the otolith rings (<code>geom_circle</code> requires the coordinate system to be fixed, so we do that here). We’ll also remove things like legend, axes, and grid lines.</p>
<pre class="r"><code>ggplot() +
  geom_raster(aes(
      x = x,
      y = y,
      fill = noise),
    data = grid) + 
  geom_circle(aes(x0 = 0.5, y0 = 0.5, r = seq(0.1, 0.5, by = 0.1)),
                fill = NA,
                size = 3) +
  coord_fixed() +
  scale_fill_viridis_c(option = &quot;inferno&quot;) +
  theme_void() +
  theme(legend.position = &quot;none&quot;)</code></pre>
<p><img src="staticunnamed-chunk-4-1.png" width="672" /></p>
<p>We’ll now use our first function from <code>ggfx</code>, <code>with_blur</code> to blur these rings a bit. This makes them much less harsh, and looks more like what you’d get from an otolith. Here the parameter ‘sigma’ controls the amount of blur we want.</p>
<pre class="r"><code>ggplot() +
  geom_raster(aes(
      x = x,
      y = y,
      fill = noise),
    data = grid) + 
  with_blur(
      geom_circle(aes(x0 = 0.5, y0 = 0.5, r = seq(0.1, 0.5, by = 0.1)),
                fill = NA,
                size = 3),
    sigma = 4) +
  coord_fixed() +
  scale_fill_viridis_c(option = &quot;inferno&quot;) +
  theme_void() +
  theme(legend.position = &quot;none&quot;)</code></pre>
<p><img src="staticunnamed-chunk-5-1.png" width="672" /></p>
<p>Now we’ll add a layer of text in for the packages name. We’ll start by just adding it as a simple layer, then blending it in later.</p>
<pre class="r"><code>ggplot() +
  geom_raster(aes(
      x = x,
      y = y,
      fill = noise),
    data = grid) + 
  geom_text(aes(x = 0.5, y = 0.5, label = &#39;Nebula&#39;), size = 19) +
  with_blur(
      geom_circle(aes(x0 = 0.5, y0 = 0.5, r = seq(0.1, 0.5, by = 0.1)),
                fill = NA,
                size = 3),
    sigma = 4) +
  coord_fixed() +
  scale_fill_viridis_c(option = &quot;inferno&quot;) +
  theme_void() +
  theme(legend.position = &quot;none&quot;)</code></pre>
<p><img src="staticunnamed-chunk-6-1.png" width="672" /></p>
<p>Then finally, we want to blend the circle layer and the text layer together. Check out <a href="https://www.data-imaginist.com/2021/say-goodbye-to-good-taste/">Thomas’ release post</a> for an explanation of how this works.</p>
<pre class="r"><code>ggplot() +
  geom_raster(mapping = aes(x = x, y = y, fill = noise), data = grid) + 
  as_reference(
    geom_text(aes(x = 0.5, y = 0.5, label = &#39;Nebula&#39;), size = 19, family = &#39;Fontania&#39;),
    id = &#39;text_layer&#39;
  ) +
  with_blend(
    with_blur(
      geom_circle(aes(x0 = 0.5, y0 = 0.5, r = seq(0.1, 0.5, by = 0.1)),
                fill = NA,
                size = 3),
    sigma = 4),
    bg_layer = &#39;text_layer&#39;,
    blend_type = &#39;xor&#39;
  ) + 
  scale_fill_viridis_c(option = &quot;inferno&quot;) +
  coord_fixed() +
  theme_void() +
  theme(legend.position = &quot;none&quot;)</code></pre>
<p><img src="staticunnamed-chunk-7-1.png" width="672" /></p>
<p>And that is the <code>nebula</code> logo, made entirely within R. To turn it into the classic ‘hex’ shape used by most R logos, I ran it through <a href="https://www.loonapix.com/trimmer/">loonapix</a>.</p>
<p>I should clarify here that I am not a designer, and I do not claim that this is an objectively ‘good’ piece of design. However, I am happy with it, and I really enjoyed creating it. I hope you also have fun exploring these packages.</p>
